C51 COMPILER V9.59.0.0   MAIN                                                              10/26/2022 13:04:35 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\OUTPUT\main.obj
COMPILER INVOKED BY: D:\Keil_C51\C51\BIN\C51.EXE USER\main.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\USER;.\SYSTEM;.\HAR
                    -DWARE) DEBUG OBJECTEXTEND PRINT(.\main.lst) TABS(2) OBJECT(.\OUTPUT\main.obj)

line level    source

   1            
   2          /**-------------------------------------------------------------------------------------------------------
             --
   3          ** Created by:      zjjohn
   4          ** Created date:    2022-10-9
   5          ** Version:         1.0.0.C
   6          ** Descriptions:    DS18B20*8 + SHT30 * 1 = 9 ÎÂ¶È + 1 Êª¶È
   7          ** ´Ë°æ±¾µ÷ÊÔ¿Ú²»Êä³öDEBUGÐÅÏ¢ £¨ÎÞprintf£©
   8          **********************************************************************************************************
             -/
   9          
  10          #include  "config.h"
  11          #include  "uart.h"
  12          #include  "ds18b20.h" 
  13          #include "sht30.h"
  14          #include  "wdt.h" 
  15          #include  "receservice.h" 
  16          
  17          /***************************************************************************
  18                                    È«¾Ö±äÁ¿¶¨Òå
  19          
  20           **************************************************************************/
  21          extern uint8 dipkey;              //dip8¿ª¹ØµÄ×´Ì¬£¬ÐèÒª³õÊ¼»¯£¬²¢ÊµÊ±¼à²â
  22          //uint8 CHNUM = 8;                  //ÎÂ¶È´«¸ÐÆ÷µÄÂ·Êý1Â·»ò8Â·
  23          //extern  unsigned char strTemp[30];
  24          
  25          /***************************************************************************
  26           * Ãè  Êö : Ö÷º¯Êý
  27           * Èë  ²Î : ÎÞ
  28           * ·µ»ØÖµ : ÎÞ
  29           **************************************************************************/
  30          void  main()
  31          {    
  32   1        uint8 TempCount = 0;
  33   1        uint8 autoTxCount = 0;          //¹¤×÷ÁÙÊ±¼ÆÊý±äÁ¿£¬×Ô¶¯·¢ËÍ¹¦ÄÜÓÃ
  34   1      //  unsigned char strTemp[8];       //´®¿Úµ÷ÊÔ£¬Êä³öÓÃÁÙÊ±±äÁ¿
  35   1      
  36   1        IO_init();                      //IO¿Ú¿ª»ú³õÊ¼»¯¡¢LED²âÊÔ
  37   1        
  38   1        //uart1_rece_ack();   //µ÷ÊÔÓÃ  ÏòÖ÷»ú»ØËÍ²âÎÂÐÅÏ¢£»
  39   1        //uart1_auto_tx();    //µ÷ÊÔÓÃ  ×Ô¶¯»Ø´«  
  40   1        //EEPROM_Init();      //µ÷ÊÔÓÃ  
  41   1      
  42   1        if(dipkey_init()) EEPROM_Init();    //³õÊ¼»¯EEPROM£¬µÚÒ»´ÎÈ±Ê¡²ÎÊý£¬Ö®ºóÒÑ¾­ÉèÖÃµÄ²ÎÊý  
  43   1        Timer0Init();         //³õÊ¼»¯¶¨Ê±Æ÷0,×÷´®¿ÚÖ¡½áÊøµÄ¶¨Ê±Æ÷£¬£³¸ö½ÓÊÕbautÊ±¼ä³¤¶È
  44   1        Uart1_Init();         //´®¿Ú1³õÊ¼»¯£¬È±Ê¡9600£¬8£¬1-STOP£¬0-crc
  45   1        SHT3X_Init();         //sh30³õÊ¼»¯
  46   1        
  47   1        EA = 1;               //×ÜÖÐ¶Ï´ò¿ª  
  48   1        
  49   1        TXEN485 = 1;          //¿ØÖÆ485·¢ËÍ¹¦ÄÜ£¬ÐèÒª·¢ËÍÊ±Éè¶¨
  50   1        
  51   1        SendDataByUart1(BaudAddr[0]),SendDataByUart1(BaudAddr[1]),SendDataByUart1(BaudAddr[2]); //ÏÔÊ¾³õÊ¼¹¤×÷²ÎÊ
             -ý
C51 COMPILER V9.59.0.0   MAIN                                                              10/26/2022 13:04:35 PAGE 2   

  52   1      
  53   1        TXEN485 = 0;          //¿ØÖÆ485½ÓÊÕ¹¦ÄÜ
  54   1        
  55   1        WDT_config();          //¿´ÃÅ¹·³õÊ¼»¯  256T·ÖÆµ  12MÆµÂÊÏÂ8Ãë
  56   1                
  57   1        while(1)
  58   1        {
  59   2      /***********************Í¬Ê±»ñÈ¡1Â·ÎÂ¶ÈºÍ1Â·Êª¶È********************************/     
  60   2      //    if(CHNUM == 8)    
  61   2      //    if(CHNUM == 1)    fTempM[0] = floatReadDs18B20();   //»ñÈ¡1Â·ÎÂ¶È£¬Í¬Ê±ÔÚ×ª»»µÄ¼äÏ¶£¬²éÑ¯´®¿ÚÃüÁî£¬·¢ËÍÓ¦
             -´ð
  62   2          
  63   2          floatReadDs18B20_8(fTempM6[TempCount++]);       //»ñÈ¡8Â·ÎÂ¶È£¬Í¬Ê±ÔÚ×ª»»µÄ¼äÏ¶£¬²éÑ¯´®¿ÚÃüÁî£¬·¢ËÍÓ¦´ð
  64   2          SHT3X_Get();                      //»ñÈ¡µÚ9Â·ÎÂ¶È£¬µÚ10Â·Êª¶È,£¨Ã¿´Î¶¼³õÊ¼»¯-ÒÑ¾­ÐÞ¸Ä)
  65   2          if(TempCount == 6)  TempCount =0;
  66   2          
  67   2          
  68   2      /***********************×Ô¶¯·¢ËÍ¹¦ÄÜ*******************************************/        
  69   2          if(BaudAddr[2])           //Èç¹û²»Îª0£¬ÔòÒÔ´ËÎª¼ä¸ôÖÜÆÚ£¬×Ô¶¯·¢ËÍ
  70   2          {
  71   3            if(autoTxCount++ == BaudAddr[2])  
  72   3            {
  73   4              uart1_auto_tx();          //×Ô¶¯·¢ËÍÎÂ¶ÈÊý¾Ý£¬8Â·»ò1Â·
  74   4              autoTxCount = 0; 
  75   4            }
  76   3          }
  77   2          
  78   2      /***********************DIP¿ª¹Ø±ä»¯£¬¶¯Ì¬ÊÊÓ¦**********************************/    
  79   2          if(dipkey != ~P2)           
  80   2          {
  81   3              if((P2 & 0x1f) == 0x1f) EEPROM_Factory();       //DIP¿ª¹ØµØÖ·Îª0£¬²»Æð×÷ÓÃ£¬³ö³§ÉèÖÃ
  82   3              IAP_CONTR = 0x20;                 //ÖØÆô¶¯     //¼ì²âÈç¹û¿ª¹Ø±ä»¯£¬ÖØÆô¶¯£¬³õÊ¼»¯
  83   3          }
  84   2          Wdt_Feed();               //Î¹¹·9ÃëÖ®ÄÚÐèÒªÎ¹¹·  ·ÖÆµ256£¬Ê±ÖÓ11.0592MHz
  85   2      
  86   2          LED_R = ~LED_R;  
  87   2        } 
  88   1      }  
  89          
  90          
  91          /******************************* END  FILE**************************************/
  92          
  93          //  uint  j;
  94          //**************²âÊÔdip8¿ª¹Ø****************//
  95          //dipkey_init();  
  96          //while(1)
  97          //{
  98          
  99          //  if(dipkey != ~P2) LED_R = 0 ;     //µãÁÁºìÉ«LED
 100          //  delay_ms(1000);     
 101          //  LED_R = 1 ;   
 102          //}
 103          
 104          /***************Ë«Â·ÎÂ¶È¡¢Êª¶ÈÊ¹ÓÃ*****************/    
 105          //    if(i++==40)
 106          //    {
 107          //        SHT3X_Get();                //SHT30º¯Êý »ñÈ¡ÎÂ¶È¡¢Êª¶È
 108          //        i=0;
 109          //    }   
 110          //    uart1_rece_proc();
 111          //    delay_ms(5);                    //5ms¼ä¸ô²éÑ¯ÖÐ¶Ï
 112          //    if((BaudAddr[2]) && (j++==200))   //Èç¹û²»Îª0£¬ÔòÒÔ´ËÎª¼ä¸ôÖÜÆÚ£¬×Ô¶¯·¢ËÍ,Í¬Ê±²½½øËÙ¶È1Ãë
C51 COMPILER V9.59.0.0   MAIN                                                              10/26/2022 13:04:35 PAGE 3   

 113          //    {
 114          //      j=0;
 115          //      if(autoTxCount++ == BaudAddr[2])  
 116          //      {
 117          //        uart1_auto_tx();            //×Ô¶¯·¢ËÍÎÂ¶ÈºÍÊª¶ÈÊý¾Ý
 118          //        autoTxCount = 0; 
 119          //      }
 120          //    }
 121          //  
 122          //      if(BaudAddr[2])           //Èç¹û²»Îª0£¬ÔòÒÔ´ËÎª¼ä¸ôÖÜÆÚ£¬×Ô¶¯·¢ËÍ
 123          //    {
 124          //      if(autoTxCount++ == BaudAddr[2])  
 125          //      {
 126          //        uart1_auto_tx();          //×Ô¶¯·¢ËÍÎÂ¶ÈÊý¾Ý£¬8Â·»ò1Â·
 127          //        autoTxCount = 0; 
 128          //      }
 129          //    }
 130          //        if(BaudAddr[2])           //Èç¹û²»Îª0£¬ÔòÒÔ´ËÎª¼ä¸ôÖÜÆÚ£¬×Ô¶¯·¢ËÍ
 131          //    {
 132          //      if(autoTxCount++ == BaudAddr[2])  
 133          //      {
 134          //        uart1_auto_tx();          //×Ô¶¯·¢ËÍÎÂ¶ÈÊý¾Ý£¬8Â·»ò1Â·
 135          //        autoTxCount = 0; 
 136          //      }
 137          //    }
 138            
 139            
 140          
 141          
 142          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    156    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       2
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
